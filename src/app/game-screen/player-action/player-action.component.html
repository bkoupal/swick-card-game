<div class="flex flex-col-reverse sm:flex-col gap-4 m-4">
  <!-- SWICK Ante Setting (Dealer Only) -->
  <div *ngIf="!readyMenuHidden && isDealer && !ready" class="grid gap-1">
    <span class="text-center table-font">Set Ante (Dealer)</span>
    <div class="grid grid-cols-5 gap-1">
      <button
        *ngFor="let ante of allowedAntes"
        mat-flat-button
        [color]="currentBet === ante ? 'accent' : 'primary'"
        [disabled]="betMenuDisabled"
        (click)="setBet.emit(ante)"
        class="text-xs px-2 py-1"
      >
        {{ ante }}¢
      </button>
    </div>
    <div class="text-xs text-center text-gray-400 mt-1">
      Everyone antes {{ currentBet }}¢ + dealer pays {{ currentBet + 3 }}¢
    </div>
  </div>

  <!-- SWICK Ante Display (Non-Dealers) -->
  <div *ngIf="!readyMenuHidden && !isDealer" class="grid gap-1">
    <span class="text-center table-font">Ante Set by Dealer</span>
    <div class="text-center bg-gray-700 rounded px-3 py-2">
      <div class="text-lg font-bold">{{ currentBet }}¢</div>
      <div class="text-xs text-gray-400">You will ante {{ currentBet }}¢</div>
    </div>
  </div>

  <!-- Trump Selection Menu (only for dealer) -->
  <div class="pill-menu" *ngIf="trumpSelectionMenuVisible">
    <span class="whitespace-normal">Trump Card: {{ trumpCardDisplay }}</span>
    <button (click)="keepTrump.emit(true)" data-cy="keep-trump">
      Keep Trump
    </button>
    <button (click)="keepTrump.emit(false)" data-cy="discard-trump">
      Discard Trump
    </button>
  </div>

  <!-- Knock In Menu -->
  <div class="pill-menu" *ngIf="knockInMenuVisible">
    <span class="whitespace-normal">Trump Suit: {{ trumpSuit }}</span>
    <button (click)="knockIn.emit(true)" data-cy="knock-in">Knock In</button>
    <button (click)="knockIn.emit(false)" data-cy="pass">Pass</button>
  </div>

  <!-- Discard/Draw Menu -->
  <div class="pill-menu" *ngIf="discardDrawMenuVisible">
    <span class="whitespace-normal">
      Select cards from your hand, then choose:
    </span>
    <button
      (click)="playCards.emit()"
      data-cy="play-cards"
      class="bg-green-600 hover:bg-green-700"
    >
      Play These Cards
    </button>
    <button
      (click)="discardDraw.emit()"
      data-cy="discard-draw"
      [disabled]="selectedCardCount === 0"
      [class.opacity-50]="selectedCardCount === 0"
      [class.cursor-not-allowed]="selectedCardCount === 0"
    >
      Discard & Draw ({{ selectedCardCount }} cards)
    </button>
  </div>

  <div
    class="pill-menu"
    *ngIf="
      !readyMenuHidden && !trumpSelectionMenuVisible && !knockInMenuVisible
    "
  >
    <!-- Show "Waiting for dealer to set ante" for non-dealers when ante is default -->
    <div
      *ngIf="!isDealer && isWaitingForAnteSet"
      class="text-center text-yellow-400"
    >
      <div class="text-sm">Waiting for dealer</div>
      <div class="text-xs">to set ante amount</div>
    </div>

    <!-- Normal ready controls when ante is set -->
    <div
      *ngIf="isDealer || !isWaitingForAnteSet"
      class="flex items-center w-full"
    >
      <button style="flex-grow: 100" (click)="readyChange.emit(!ready)">
        {{ ready ? "Not ready" : "Ready" }}
      </button>
      <div class="h-9">
        <mat-checkbox
          class="-mt-2.5 mr-4"
          [checked]="autoReady"
          (change)="autoReadyChange.emit($event.checked)"
          matTooltip="Automatically sets player as ready after every round"
          >Auto Ready</mat-checkbox
        >
      </div>
    </div>
  </div>

  <div
    class="pill-menu"
    *ngIf="
      readyMenuHidden &&
      !trumpSelectionMenuVisible &&
      !knockInMenuVisible &&
      cardPlayPhase
    "
  >
    <span class="whitespace-normal text-center">
      Click a card from your hand to play it
    </span>
  </div>
</div>
